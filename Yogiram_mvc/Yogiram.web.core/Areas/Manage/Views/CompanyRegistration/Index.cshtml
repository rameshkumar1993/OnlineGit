@model CompanyModel

@{
    ViewBag.Title = "Company Registration";
}




<div class="content">
    <div class="container-fluid">
        <div class="row datatable-widget">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header card-header-icon" data-background-color="rose">
                        <i class="material-icons">perm_identity</i>
                    </div>

                    <div class="card-content">
                        <h4 class="card-title">
                            Employee Information -
                            <small class="category">Complete your profile</small>
                        </h4>
                        <div class="toolbar text-left">
                            <button type="button" class="btn btn-rose btn-fill add" style="padding-left: 20px;padding-right: 20px;">@R.G("ADD")</button>
                            <!--        Here you can write extra buttons/actions for the toolbar              -->
                        </div>
                        <div class="material-datatables">
                            <table id="datatables" class="table table-striped table-bordered table-hover" cellspacing="0" width="100%" style="width:100%">
                                <thead>
                                    <tr>
                                        <th class="text-center">@R.M("CompanyName")</th>
                                        <th class="text-center">@R.M("CompanyShortName")</th>
                                        <th class="text-center">@R.M("CompanyCode")</th>
                                        <th class="text-center">@R.M("TelePhoneNo")</th>
                                        <th class="disabled-sorting text-center">@R.G("Actions")</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <div class="row form-widget" style="display:none">
            @using (Html.BeginForm("Index", "CompanyRegistration", FormMethod.Post, new { id = "CompanyRegister" }))
            {
                <div class="content">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="card">
                                    <div class="card-header card-header-icon" data-background-color="rose">
                                        <i class="material-icons">perm_identity</i>
                                    </div>

                                    <div class="card-content">
                                        <h4 class="card-title">
                                            Company Information -
                                            <small class="category">Complete your profile</small>
                                        </h4>

                                        <div class="row">
                                            @Html.HiddenFor(model => model.CompanyId)
                                            <div class="col-md-12">
                                                <div class="row">
                                                    <div class="col-md-3"></div>
                                                    <div class="col-md-5">
                                                        <div class="form-group label-floating">
                                                            @Html.LabelFor(model => model.CompanyName, @R.M("CompanyName"), new { @class = "control-label" })
                                                            @Html.TextBoxFor(model => model.CompanyName, new { @class = "form-control" })
                                                            @Html.ValidationMessageFor(model => model.CompanyName, "", new { @class = "text-danger" })
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-md-3"></div>
                                                    <div class="col-md-5">
                                                        <div class="form-group label-floating">
                                                            @Html.LabelFor(model => model.CompanyShortName, @R.M("CompanyShortName"), new { @class = "control-label" })
                                                            @Html.TextBoxFor(model => model.CompanyShortName, new { @class = "form-control" })
                                                            @Html.ValidationMessageFor(model => model.CompanyShortName, "", new { @class = "text-danger" })
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-md-3"></div>
                                                    <div class="col-md-5">
                                                        <div class="form-group label-floating">
                                                            @Html.LabelFor(model => model.CompanyCode, @R.M("CompanyCode"), new { @class = "control-label" })
                                                            @Html.TextBoxFor(model => model.CompanyCode, new { @class = "form-control" })
                                                            @Html.ValidationMessageFor(model => model.CompanyCode, "", new { @class = "text-danger" })
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-md-3"></div>
                                                    <div class="col-md-5">
                                                        <div class="form-group label-floating">
                                                            @Html.LabelFor(model => model.OfficalMail, new { @class = "control-label" })
                                                            @Html.TextBoxFor(model => model.OfficalMail, new { @class = "form-control" })
                                                            @Html.ValidationMessageFor(model => model.OfficalMail, "", new { @class = "text-danger" })
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-md-3"></div>
                                                    <div class="col-md-5">
                                                        <div class="form-group label-floating">
                                                            @Html.LabelFor(model => model.TelephoneNo, @R.M("TelePhoneNo"), new { @class = "control-label" })
                                                            @Html.TextBoxFor(model => model.TelephoneNo, new { @class = "form-control", maxlength = "13", type = "number", min = "0" })
                                                            @Html.ValidationMessageFor(model => model.TelephoneNo, "", new { @class = "text-danger" })
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-md-3"></div>
                                                    <div class="col-md-5">
                                                        <div class="form-group label-floating">
                                                            @Html.LabelFor(model => model.Address, @R.M("Address"), new { @class = "control-label" })
                                                            @Html.TextAreaFor(model => model.Address, new { @class = "form-control" })
                                                            @Html.ValidationMessageFor(model => model.Address, "", new { @class = "text-danger" })
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-md-3"></div>
                                                    <div class="col-md-5">
                                                        <div class="form-group label-floating">
                                                            @Html.LabelFor(model => model.Pincode, @R.M("Pincode"), new { @class = "control-label" })
                                                            @Html.TextBoxFor(model => model.Pincode, new { @class = "form-control", maxlength = "6", type = "number", min = "0" })
                                                            @Html.ValidationMessageFor(model => model.Pincode, "", new { @class = "text-danger" })
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-md-3"></div>
                                                    <div class="col-md-5">
                                                        <div class="form-group label-floating">
                                                            @Html.LabelFor(model => model.Country, new { @class = "control-label" })
                                                            @Html.TextBoxFor(model => model.Country, new { @class = "form-control" })
                                                            @Html.ValidationMessageFor(model => model.Country, "", new { @class = "text-danger" })
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <br />
                                        <br />
                                        <button type="button" id="btnCancel" class="btn btn-danger pull-left">@R.G("Cancel")</button>
                                        <button type="submit" class="btn btn-rose pull-right">@R.G("Save")</button>
                                        <div class="clearfix"></div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }

        </div>
    </div>
</div>


<script src="~/Scripts/jquery-1.10.2.js"></script>
<script src="~/Theme/assets/js/jquery.spinner.js"></script>

<script src="~/Theme/assets/js/jquery-3.2.1.js"></script>

<script src="~/Theme/assets/js/bootstrap.min.js" type="text/javascript"></script>
<script src="~/Theme/assets/js/material.min.js" type="text/javascript"></script>

<script src="~/Theme/assets/js/perfect-scrollbar.jquery.min.js" type="text/javascript"></script>

<!-- Include a polyfill for ES6 Promises (optional) for IE11, UC Browser and Android browser support SweetAlert -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/core-js/2.4.1/core.js"></script>

<script src="~/Theme/assets/js/jquery.validate.min.js"></script>

<script src="~/Theme/assets/js/moment.min.js"></script>

<script src="~/Theme/assets/js/jquery.bootstrap-wizard.js"></script>

<script src="~/Theme/assets/js/bootstrap-notify.js"></script>

<script src="~/Theme/assets/js/bootstrap-datetimepicker.js"></script>

<script src="~/Theme/assets/js/jquery.select-bootstrap.js"></script>

<script src="~/Theme/assets/js/jquery.datatables.js"></script>

<script src="~/Theme/assets/js/sweetalert2.js"></script>

<script src="~/Theme/assets/js/jasny-bootstrap.min.js"></script>

<script src="~/Theme/assets/js/fullcalendar.min.js"></script>

<script src="~/Theme/assets/js/jquery.tagsinput.js"></script>

<script src="~/Theme/assets/js/material-dashboard.js?v=1.2.1"></script>

<script src="~/Theme/assets/js/demo.js"></script>

<script src="~/Scripts/jquery.validate.min.js"></script>
<script src="~/Scripts/jquery.validate.unobtrusive.js"></script>

<link href="~/Theme/Select2 Meterial/select2/css/pmd-select2.css" rel="stylesheet" />
<link href="~/Theme/Select2 Meterial/select2/css/select2.min.css" rel="stylesheet" />
<script src="~/Theme/Select2 Meterial/select2/js/select2.full.js"></script>

<script src="~/Theme/Select2 Meterial/select2/js/pmd-select2.js"></script>
<link href="~/Theme/Select2 Meterial/select2/css/select2-bootstrap.css" rel="stylesheet" />

<script type="text/javascript">

    var datatable;

    $(document).ready(function () {

        datatable = $('#datatables').DataTable({

            processing: true,
            serverSide: true,

            "pagingType": "full_numbers",
            "lengthMenu": [
                [10, 25, 50, -1],
                [10, 25, 50, "All"]
            ],

            'columnDefs': [
                 { "className": "text-center", "targets": "4" }
            ],
            ajax:
                {
                    url: "/Manage/CompanyRegistration/LoadCompany",
                    type: "POST",
                    datatype: "json"
                },
            columns: [
                { data: "CompanyName", autowidth: true, bSortable: true, bOrderable: true },
                { data: "CompanyShortName", autowidth: true, bSortable: true, bOrderable: true },
                { data: "CompanyCode", autowidth: true, bSortable: true, bOrderable: true },

                { data: "TelphoneNo", autowidth: true, bSortable: true, bOrderable: true },
                {
                    data: "CompanyId",
                    render: function (data, type, full, meta) {
                        var inner = '<div class="td-actions text-center"><a class="btn btn-success edit"><i class="material-icons">edit</i></a></div>'
                        return inner;
                    },
                }],

            responsive: true,
            language: {
                search: "",
                searchPlaceholder: "Search records",
                sProcessing: '<span id="js-one" data-spinner="{&quot;radius&quot;: 25}"></span>'
            }
        });

        datatable.on('click', '.edit', function () {

            //ResetForm();
            var row = datatable.row($(this).closest('tr')).data();

            $("#CompanyId").val(row.CompanyId);
            $("#CompanyName").focus().val(row.CompanyName);
            $("#CompanyShortName").val(row.CompanyShortName);
            $("#CompanyCode").val(row.CompanyCode);
            $("#OfficalMail").val(row.OfficialMail);
            $("#Address").val(row.Address);
            $("#TelephoneNo").val(row.TelphoneNo);
            $("#Pincode").val(row.Pincode);
            $("#Country").val(row.Country);

            $('div').removeClass('is-empty');

            $(".form-widget").show();
            $(".datatable-widget").hide();
           
        });

        $(".add").click(function () {

            ResetForm();
            $(".form-widget").show();
            $(".datatable-widget").hide();
            
        });

        $("#btnCancel").click(function () {

            ResetForm();
            $(".form-widget").hide();
            $(".datatable-widget").show();
        });

        $('#CompanyRegister').submit(function () {

            var formData = new FormData(this);

            if ($(this).valid()) {
                $.ajax({
                    url: this.action,
                    type: this.method,
                    data: formData,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        try {
                            if (response.error) {
                                notifyError(response.error, '@ViewBag.Title');
                                return;
                            }
                            else {

                                datatable.draw();
                                $(".datatable-widget").show();
                                $(".form-widget").hide();
                                notifySuccess(response.msg, '@ViewBag.Title');
                            }
                        } catch (e) {
                            if (window.console)
                                console.error(e);

                            notifyError("Error", '@ViewBag.Title');
                        }
                    }
                });
            }

            return false;
        });

        
        $("[data-val-required]").each(function () {
            var label = $('label[for="' + $(this).attr("id") + '"]');
            var asterisksHtml = '<span style="color:red">&nbsp;*</span>';
            if (label.text().length > 0 && label.html().indexOf(asterisksHtml) === -1) {
                label.append(asterisksHtml);
            }
        });


        setTimeout(function () {
            $('.card.wizard-card').addClass('active');
        }, 600);

        $("#datatables_filter label").addClass("form-group");

        $(".dataTables_length").addClass("form-group-sm");
    });


    function ResetForm() {
        $("#CompanyRegister").validate().resetForm();
        $(".field-validation-error span").hide();
        $('#CompanyRegister').get(0).reset();
        $('div').addClass('is-empty');
    }

    demo.initFormExtendedDatetimepickers();
    demo.initMaterialWizard();

</script>

